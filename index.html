<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Prueba Google Sheets</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.5.1/tabletop.min.js"></script>
</head>
<body style="font-family:Arial;text-align:center;">
  <h1>Test conexi√≥n Google Sheets</h1>
  <div id="output">Cargando datos...</div>

  <script>
    const SHEET_ID = '100wFVVxz7NQKgx27O8IFwwan0bWpvnXUExuo0Pt7zL0';

    Tabletop.init({
      key: `https://docs.google.com/spreadsheets/d/${SHEET_ID}/pubhtml`,
      simpleSheet: true,
      callback: function(data, tabletop) {
        console.log("Datos cargados:", data); // Mira en la consola del navegador
        if (data.length === 0) {
          document.getElementById('output').innerHTML = "No se encontraron datos.";
          return;
        }
        // Mostrar datos en HTML
        let html = "<table border='1' style='margin:0 auto;'><tr>";
        Object.keys(data[0]).forEach(key => {
          html += `<th>${key}</th>`;
        });
        html += "</tr>";
        data.forEach(row => {
          html += "<tr>";
          for (let key in row) {
            html += `<td>${row[key]}</td>`;
          }
          html += "</tr>";
        });
        html += "</table>";
        document.getElementById('output').innerHTML = html;
      }
    });
  </script>
</body>
</html>
